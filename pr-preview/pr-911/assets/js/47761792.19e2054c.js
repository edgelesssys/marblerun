"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[8250],{4888:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>h,frontMatter:()=>a,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"getting-started/quickstart","title":"First steps with MarbleRun","description":"The following steps guide you through the process of deploying MarbleRun in your cluster and deploying a sample app. This example assumes that you have successfully installed MarbleRun, and have access to a Kubernetes cluster.","source":"@site/versioned_docs/version-1.5/getting-started/quickstart.md","sourceDirName":"getting-started","slug":"/getting-started/quickstart","permalink":"/marblerun/pr-preview/pr-911/1.5/getting-started/quickstart","draft":false,"unlisted":false,"editUrl":"https://github.com/edgelesssys/marblerun/edit/master/docs/versioned_docs/version-1.5/getting-started/quickstart.md","tags":[],"version":"1.5","frontMatter":{},"sidebar":"docs","previous":{"title":"Installation","permalink":"/marblerun/pr-preview/pr-911/1.5/getting-started/installation"},"next":{"title":"Examples","permalink":"/marblerun/pr-preview/pr-911/1.5/getting-started/examples"}}');var s=t(74848),o=t(28453);const a={},i="First steps with MarbleRun",l={},c=[{value:"Step 0: Clone the demo repository",id:"step-0-clone-the-demo-repository",level:2},{value:"Step 1: Install the control plane onto your cluster",id:"step-1-install-the-control-plane-onto-your-cluster",level:2},{value:"Step 2: Configure MarbleRun",id:"step-2-configure-marblerun",level:3},{value:"Step 3: Deploy the demo application",id:"step-3-deploy-the-demo-application",level:2},{value:"Step 4: Watch it run",id:"step-4-watch-it-run",level:2},{value:"That\u2019s it \ud83d\udc4f",id:"thats-it-",level:2}];function d(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components},{TabItem:t,Tabs:r}=n;return t||u("TabItem",!0),r||u("Tabs",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"first-steps-with-marblerun",children:"First steps with MarbleRun"})}),"\n",(0,s.jsxs)(n.p,{children:["The following steps guide you through the process of deploying MarbleRun in your cluster and deploying a sample app. This example assumes that you have successfully ",(0,s.jsx)(n.a,{href:"/marblerun/pr-preview/pr-911/1.5/getting-started/installation",children:"installed MarbleRun"}),", and have access to a Kubernetes cluster."]}),"\n",(0,s.jsxs)(n.p,{children:["A working SGX DCAP environment is required for MarbleRun. For ease of exploring and testing, we provide a simulation mode with ",(0,s.jsx)(n.code,{children:"--simulation"})," that runs without SGX hardware.\nDepending on your setup, you may follow the quickstart for SGX-enabled clusters. Alternatively, if your setup doesn't support SGX, you can follow the quickstart in simulation mode by selecting the respective tabs."]}),"\n",(0,s.jsx)(n.h2,{id:"step-0-clone-the-demo-repository",children:"Step 0: Clone the demo repository"}),"\n",(0,s.jsxs)(n.p,{children:["To get a feel for how MarbleRun would work for one of your services, you can install a demo application.\nThe emojivoto application is a standalone Kubernetes application that uses a mix of gRPC and HTTP calls to allow users to vote on their favorite emojis.\nCreated as a demo application for the popular ",(0,s.jsx)(n.a,{href:"https://linkerd.io",children:"Linkerd"})," service mesh, we've made a confidential variant that uses a confidential service mesh for all gRPC and HTTP connections.\nClone the ",(0,s.jsx)(n.a,{href:"https://github.com/edgelesssys/emojivoto",children:"demo application's repository"})," from GitHub by running the following:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/edgelesssys/emojivoto && cd emojivoto\n"})}),"\n",(0,s.jsx)(n.h2,{id:"step-1-install-the-control-plane-onto-your-cluster",children:"Step 1: Install the control plane onto your cluster"}),"\n",(0,s.jsxs)(n.p,{children:["Install MarbleRun's ",(0,s.jsx)(n.em,{children:"Coordinator"})," control plane by running:"]}),"\n",(0,s.jsxs)(r,{groupId:"mode",children:[(0,s.jsxs)(t,{value:"SGX",label:"With SGX",children:[(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"marblerun install\n"})}),(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"marblerun install"})," command generates a Kubernetes manifest with all the necessary control plane resources.\nThis includes a deployment for the Coordinator and for MarbleRun's ",(0,s.jsx)(n.a,{href:"/marblerun/pr-preview/pr-911/1.5/features/kubernetes-integration",children:"admission controller."})]})]}),(0,s.jsxs)(t,{value:"Simulation",label:"In simulation mode",children:[(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"marblerun install --simulation\n"})}),(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"marblerun install"})," command generates a Kubernetes manifest with all the necessary control plane resources.\nThis includes a deployment for the Coordinator and for MarbleRun's ",(0,s.jsx)(n.a,{href:"/marblerun/pr-preview/pr-911/1.5/features/kubernetes-integration",children:"admission controller."}),"\nThe simulation flag tells MarbleRun that real SGX hardware might not be present and the SGX layer should be emulated."]})]})]}),"\n",(0,s.jsx)(n.p,{children:"Wait for the control plane to finish installing:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"marblerun check\n"})}),"\n",(0,s.jsx)(n.p,{children:"This command will wait until all components of MarbleRun are ready to be used or return an error after a timeout period is reached."}),"\n",(0,s.jsx)(n.p,{children:"Port forward the Coordinator's Client API:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"kubectl -n marblerun port-forward svc/coordinator-client-api 4433:4433 --address localhost >/dev/null &\nexport MARBLERUN=localhost:4433\n"})}),"\n",(0,s.jsx)(n.h3,{id:"step-2-configure-marblerun",children:"Step 2: Configure MarbleRun"}),"\n",(0,s.jsxs)(n.p,{children:["MarbleRun guarantees that the topology of your distributed app adheres to a manifest specified in simple JSON.\nMarbleRun verifies the integrity of services, bootstraps them, and sets up encrypted connections between them.\nThe emojivoto demo already comes with a ",(0,s.jsx)(n.a,{href:"https://github.com/edgelesssys/emojivoto/blob/main/tools/manifest.json",children:"manifest"}),", which you can deploy onto MarbleRun by running the following:"]}),"\n",(0,s.jsxs)(r,{groupId:"mode",children:[(0,s.jsxs)(t,{value:"SGX",label:"With SGX",children:[(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"marblerun manifest set tools/manifest.json $MARBLERUN\n"})}),(0,s.jsxs)(n.p,{children:["The CLI will obtain the Coordinator's remote attestation quote and verify it against the configuration on our ",(0,s.jsx)(n.a,{href:"https://github.com/edgelesssys/marblerun/releases/latest/download/coordinator-era.json",children:"release page"}),".\nThe SGX quote proves the integrity of the Coordinator pod.\nThe CLI saves the TLS certificate of the Coordinator as ",(0,s.jsx)(n.code,{children:"coordinator-cert.pem"})," in your config directory.\nThe certificate is bound to the quote and is used by the CLI for future verification.\nIt can also be used as a root of trust for ",(0,s.jsx)(n.a,{href:"/marblerun/pr-preview/pr-911/1.5/features/attestation",children:"authenticating your confidential applications"}),"."]}),(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["By default the certificate is saved to ",(0,s.jsx)(n.code,{children:"$XDG_CONFIG_HOME/marblerun/coordinator-cert.pem"}),",\nor ",(0,s.jsx)(n.code,{children:"$HOME/.config/marblerun/coordinator-cert.pem"})," if ",(0,s.jsx)(n.code,{children:"$XDG_CONFIG_HOME"})," isn't set.\nSubsequent CLI commands will try loading the certificate from that location.\nUse the ",(0,s.jsx)(n.code,{children:"--coordinator-cert"})," flag to choose your own location to save or load the certificate."]})})]}),(0,s.jsxs)(t,{value:"Simulation",label:"In simulation mode",children:[(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"marblerun manifest set tools/manifest.json $MARBLERUN --insecure\n"})}),(0,s.jsx)(n.p,{children:"The insecure flag tells MarbleRun that real SGX hardware might not be present and the quote verification should be omitted.\nSince this bypasses all security checks on the TLS connection to the Coordinator, you MUST NOT use it in production."})]})]}),"\n",(0,s.jsx)(n.p,{children:"You can check that the state of MarbleRun has changed and is now ready to authenticate your services by running:"}),"\n",(0,s.jsxs)(r,{groupId:"mode",children:[(0,s.jsx)(t,{value:"SGX",label:"With SGX",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"marblerun status $MARBLERUN\n"})})}),(0,s.jsx)(t,{value:"Simulation",label:"In simulation mode",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"marblerun status $MARBLERUN --insecure\n"})})})]}),"\n",(0,s.jsx)(n.h2,{id:"step-3-deploy-the-demo-application",children:"Step 3: Deploy the demo application"}),"\n",(0,s.jsxs)(n.p,{children:["Finally, install the demo application onto your cluster.\nPlease make sure you have ",(0,s.jsx)(n.a,{href:"https://helm.sh/docs/intro/install/",children:"Helm"}),' ("the package manager for Kubernetes") installed at least at Version v3.2.0.\nInstall emojivoto into the emojivoto namespace by running:']}),"\n",(0,s.jsxs)(r,{groupId:"mode",children:[(0,s.jsx)(t,{value:"SGX",label:"With SGX",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"helm install -f ./kubernetes/sgx_values.yaml emojivoto ./kubernetes --create-namespace -n emojivoto\n"})})}),(0,s.jsx)(t,{value:"Simulation",label:"In simulation mode",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"helm install -f ./kubernetes/nosgx_values.yaml emojivoto ./kubernetes --create-namespace -n emojivoto\n"})})})]}),"\n",(0,s.jsx)(n.h2,{id:"step-4-watch-it-run",children:"Step 4: Watch it run"}),"\n",(0,s.jsx)(n.p,{children:"You can now check the MarbleRun log and see the services being authenticated by the Coordinator."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"kubectl -n marblerun logs -f -l edgeless.systems/control-plane-component=coordinator\n"})}),"\n",(0,s.jsx)(n.p,{children:"Port forward the front-end web service to access it on your local machine by running:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"kubectl -n emojivoto port-forward svc/web-svc 8443:443 --address 0.0.0.0\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Now visit ",(0,s.jsx)(n.a,{href:"https://localhost:8443",children:"https://localhost:8443"}),".\nYou'll be presented with a certificate warning because your browser, by default, doesn't trust certificates signed by MarbleRun.\nYou can ignore this error for now and proceed to the website.",(0,s.jsx)(n.br,{}),"\n","Voila! Your emoji votes have never been safer!"]}),"\n",(0,s.jsx)(n.h2,{id:"thats-it-",children:"That\u2019s it \ud83d\udc4f"}),"\n",(0,s.jsx)(n.p,{children:"Congratulations, you\u2019re now a MarbleRun user! Here are some suggested next steps:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Explore how ",(0,s.jsx)(n.a,{href:"/marblerun/pr-preview/pr-911/1.5/features/secrets-management",children:"MarbleRun takes care of your secrets"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"/marblerun/pr-preview/pr-911/1.5/workflows/add-service",children:"Add your own service"})," to MarbleRun"]}),"\n",(0,s.jsxs)(n.li,{children:["Learn more about ",(0,s.jsx)(n.a,{href:"/marblerun/pr-preview/pr-911/1.5/architecture/concepts",children:"MarbleRun\u2019s architecture"})]}),"\n",(0,s.jsxs)(n.li,{children:["Try out the full demo on ",(0,s.jsx)(n.a,{href:"https://github.com/edgelesssys/emojivoto",children:"GitHub"})]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Welcome to the MarbleRun community!"})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}function u(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},28453:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>i});var r=t(96540);const s={},o=r.createContext(s);function a(e){const n=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);