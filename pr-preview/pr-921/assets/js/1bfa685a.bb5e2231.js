"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[4189],{28453:(e,n,i)=>{i.d(n,{R:()=>s,x:()=>a});var t=i(96540);const o={},r=t.createContext(o);function s(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),t.createElement(r.Provider,{value:n},e.children)}},87022:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"workflows/verification","title":"Verifying a deployment","description":"The Coordinator provides an API for clients to verify the identity and integrity of the Coordinator itself and the deployed Marbles.","source":"@site/versioned_docs/version-1.5/workflows/verification.md","sourceDirName":"workflows","slug":"/workflows/verification","permalink":"/marblerun/pr-preview/pr-921/1.5/workflows/verification","draft":false,"unlisted":false,"editUrl":"https://github.com/edgelesssys/marblerun/edit/master/docs/versioned_docs/version-1.5/workflows/verification.md","tags":[],"version":"1.5","frontMatter":{},"sidebar":"docs","previous":{"title":"Add a service","permalink":"/marblerun/pr-preview/pr-921/1.5/workflows/add-service"},"next":{"title":"Monitoring and logging","permalink":"/marblerun/pr-preview/pr-921/1.5/workflows/monitoring"}}');var o=i(74848),r=i(28453);const s={},a="Verifying a deployment",d={},c=[{value:"Verifying the quote and the manifest using the CLI",id:"verifying-the-quote-and-the-manifest-using-the-cli",level:2}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"verifying-a-deployment",children:"Verifying a deployment"})}),"\n",(0,o.jsx)(n.p,{children:"The Coordinator provides an API for clients to verify the identity and integrity of the Coordinator itself and the deployed Marbles."}),"\n",(0,o.jsxs)(n.p,{children:["Specifically, the Coordinator exposes the ",(0,o.jsx)(n.code,{children:"/quote"})," endpoint that returns a quote and a certificate chain consisting of a root CA and an intermediate CA. The root CA is fixed for the lifetime of your deployment, while the intermediate CA changes in case you ",(0,o.jsx)(n.a,{href:"/marblerun/pr-preview/pr-921/1.5/workflows/update-manifest",children:"update"})," the packages specified in your manifest. The Coordinator also makes the effective manifest available via the ",(0,o.jsx)(n.code,{children:"/manifest"})," endpoint. In TLS connections with this endpoint, the Coordinator uses its root CA and intermediate CA. Learn more about this concept in the ",(0,o.jsx)(n.a,{href:"/marblerun/pr-preview/pr-921/1.5/features/attestation",children:"Attestation"})," section."]}),"\n",(0,o.jsx)(n.h2,{id:"verifying-the-quote-and-the-manifest-using-the-cli",children:"Verifying the quote and the manifest using the CLI"}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"marblerun manifest verify"})," command uses the two endpoints described above. It first verifies the Coordinator's quote according to a given policy and then checks that the expected ",(0,o.jsx)(n.code,{children:"manifest.json"})," is in effect."]}),"\n",(0,o.jsx)(n.admonition,{type:"info",children:(0,o.jsxs)(n.p,{children:["You need to ",(0,o.jsx)(n.a,{href:"/marblerun/pr-preview/pr-921/1.5/getting-started/installation#install-the-marblerun-cli",children:"install and configure a quote provider"})," before you can use the command."]})}),"\n",(0,o.jsxs)(n.p,{children:["The policy includes the Coordinator's ",(0,o.jsx)(n.code,{children:"UniqueID"})," or the tuple ",(0,o.jsx)(n.code,{children:"ProductID"}),", ",(0,o.jsx)(n.code,{children:"SecurityVersion"}),", and ",(0,o.jsx)(n.code,{children:"SignerID"}),". ",(0,o.jsx)(n.code,{children:"UniqueID"})," and ",(0,o.jsx)(n.code,{children:"SignerID"})," are also known as ",(0,o.jsx)(n.code,{children:"MRENCLAVE"})," and ",(0,o.jsx)(n.code,{children:"MRSIGNER"})," in SGX terminology. The policy for a given Coordinator is generated at build time and written to a file named ",(0,o.jsx)(n.code,{children:"coordinator-era.json"}),". This file ships with every release of MarbleRun. You can find the policy file for the latest MarbleRun release at ",(0,o.jsx)(n.code,{children:"https://github.com/edgelesssys/marblerun/releases/latest/download/coordinator-era.json"})]}),"\n",(0,o.jsx)(n.p,{children:"The command is used as follows:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"marblerun manifest verify manifest.json $MARBLERUN\n"})}),"\n",(0,o.jsx)(n.p,{children:"If successful, the certificates of the root CA and the intermediate CA are saved for future connections. This ensures you are always talking to the same verified instance."}),"\n",(0,o.jsx)(n.admonition,{type:"info",children:(0,o.jsxs)(n.p,{children:["By default, the command will save the Coordinators certificate chain to ",(0,o.jsx)(n.code,{children:"$XDG_CONFIG_HOME/marblerun/coordinator-cert.pem"}),",\nor ",(0,o.jsx)(n.code,{children:"$HOME/.config/marblerun/coordinator-cert.pem"})," if ",(0,o.jsx)(n.code,{children:"$XDG_CONFIG_HOME"})," isn't set.\nSubsequent CLI commands will try loading the certificate from that location.\nUse the ",(0,o.jsx)(n.code,{children:"--coordinator-cert"})," flag to choose your own location to save or load the certificate."]})}),"\n",(0,o.jsx)(n.admonition,{type:"info",children:(0,o.jsxs)(n.p,{children:["The flag ",(0,o.jsx)(n.code,{children:"--era-config"})," lets you optionally specify a custom policy for the verification of the quote. See the ",(0,o.jsx)(n.a,{href:"/marblerun/pr-preview/pr-921/1.5/reference/cli#marblerun-manifest-verify",children:"documentation of the command"})," for details."]})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}}}]);